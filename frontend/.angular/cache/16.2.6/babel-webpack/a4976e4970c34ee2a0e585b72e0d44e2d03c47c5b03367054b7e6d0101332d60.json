{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { User } from '../models/user';\nexport let RegisterTeacherComponent = class RegisterTeacherComponent {\n  constructor(userService) {\n    this.userService = userService;\n    this.username = \"\";\n    this.password = \"\";\n    this.safeQuestion = \"\";\n    this.safeResponse = \"\";\n    this.name = \"\";\n    this.lastName = \"\";\n    this.gender = \"\";\n    this.adr = \"\";\n    this.phone = \"\";\n    this.email = \"\";\n    this.schoolType = \"\";\n    this.grade = 0;\n    this.photo = null;\n    this.cv = null;\n    this.message = \"\";\n    this.imageWidth = 0;\n    this.imageHeight = 0;\n    this.subjects = [{\n      label: 'Matematika',\n      value: 'math'\n    }, {\n      label: 'Fizika',\n      value: 'physics'\n    }, {\n      label: 'Hemija',\n      value: 'chemistry'\n    }, {\n      label: 'Informatika',\n      value: 'info'\n    }, {\n      label: 'Programiranje',\n      value: 'programming'\n    }, {\n      label: 'Srpski jezik i književnost',\n      value: 'srb'\n    }, {\n      label: 'Engleski jezik',\n      value: 'eng'\n    }, {\n      label: 'Nemački jezik',\n      value: 'ger'\n    }, {\n      label: 'Italijanski jezik',\n      value: 'ita'\n    }, {\n      label: 'Francuski jezik',\n      value: 'fra'\n    }, {\n      label: 'Španski jezik',\n      value: 'spa'\n    }, {\n      label: 'Latinski jezik',\n      value: 'lat'\n    }, {\n      label: 'Biologija',\n      value: 'bio'\n    }, {\n      label: 'Istorija',\n      value: 'hist'\n    }, {\n      label: 'Geografija',\n      value: 'geo'\n    }, {\n      label: 'Svet oko nas',\n      value: 'world'\n    }, {\n      label: 'Nešto drugo',\n      value: 'other'\n    }];\n    this.selectedSubjects = {};\n  }\n  onFileSelected(event) {\n    this.photo = event.target.files[0];\n    const reader = new FileReader();\n    reader.onload = e => {\n      const img = new Image();\n      img.onload = () => {\n        this.imageWidth = img.naturalWidth;\n        this.imageHeight = img.naturalHeight;\n      };\n      img.src = e.target.result;\n    };\n    reader.readAsDataURL(this.photo);\n  }\n  onFileSelectedCV(event) {\n    this.cv = event.target.files[0];\n  }\n  registerUser() {\n    // lozinka\n    console.log(\"OVDe\");\n    const regex = /^(?=.*[A-Z])(?=.*[a-z]{3})(?=.*\\d)(?=.*[!@#$%^&*()-_+=])[A-Za-z][A-Za-z\\d!@#$%^&*()-_+=]{5,9}$/;\n    if (!regex.test(this.password)) {\n      this.message = \"Lozinka nije u dobrom formatu!\";\n      return;\n    }\n    const phoneRegex = /^\\+3816\\d{8,9}$/;\n    if (!phoneRegex.test(this.phone)) {\n      this.message = \"Telefon nije u dobrom formatu!\";\n      return;\n    }\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(this.email)) {\n      this.message = \"Mejl nije u dobrom formatu!\";\n      return;\n    }\n    if (this.grade < 1 || this.grade > 8) {\n      this.message = \"Razred nije validan!\";\n      return;\n    }\n    if (this.schoolType != \"osnovna\" && this.grade > 4) {\n      this.message = \"Razred nije validan za taj stepen obrazovanja!\";\n      return;\n    }\n    let usePhoto = false;\n    if (!this.photo) {\n      usePhoto = true;\n    } else {\n      if (this.imageWidth > 300 || this.imageWidth < 100 || this.imageHeight > 300 || this.imageHeight < 100) {\n        this.message = 'Slika nije dozvoljene velicine.';\n        return;\n      }\n      const allowedFormats = ['image/jpeg', 'image/png'];\n      if (!allowedFormats.includes(this.photo.type)) {\n        this.message = 'Slika nije u dozvoljenom formatu. Dozvoljeni formati su JPG i PNG.';\n        return;\n      }\n    }\n    const imagePath = 'upload/user.png';\n    let newStudent = new User(this.username, this.password, this.safeQuestion, this.safeResponse, this.name, this.lastName, this.gender, this.adr, this.phone, this.email, imagePath, this.schoolType, this.grade);\n    this.userService.registerStudent(newStudent).subscribe(msg => {\n      this.message = msg.mess;\n      if (msg.code == 1) {\n        this.message = \"Greska na serveru\";\n        return;\n      } else if (msg.code == 2) {\n        this.message = \"Korisnik sa datim korisnickim imenom vec postoji!\";\n        return;\n      } else if (msg.code == 3) {\n        this.message = \"Korisnik sa datim mejlom vec postoji!\";\n        return;\n      } else {\n        //success\n        if (usePhoto == false) {\n          this.userService.uploadPhoto(this.photo, this.username).subscribe(user => {\n            if (user != null) {\n              localStorage.setItem(\"user\", JSON.stringify(user));\n            }\n          });\n        }\n      }\n    });\n  }\n};\nRegisterTeacherComponent = __decorate([Component({\n  selector: 'app-register-teacher',\n  templateUrl: './register-teacher.component.html',\n  styleUrls: ['./register-teacher.component.css']\n})], RegisterTeacherComponent);","map":{"version":3,"names":["Component","User","RegisterTeacherComponent","constructor","userService","username","password","safeQuestion","safeResponse","name","lastName","gender","adr","phone","email","schoolType","grade","photo","cv","message","imageWidth","imageHeight","subjects","label","value","selectedSubjects","onFileSelected","event","target","files","reader","FileReader","onload","e","img","Image","naturalWidth","naturalHeight","src","result","readAsDataURL","onFileSelectedCV","registerUser","console","log","regex","test","phoneRegex","emailRegex","usePhoto","allowedFormats","includes","type","imagePath","newStudent","registerStudent","subscribe","msg","mess","code","uploadPhoto","user","localStorage","setItem","JSON","stringify","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\Lenovo\\OneDrive\\Desktop\\PiaProjekat\\frontend\\src\\app\\register-teacher\\register-teacher.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { UserService } from '../user.service';\nimport { User } from '../models/user';\n\n@Component({\n  selector: 'app-register-teacher',\n  templateUrl: './register-teacher.component.html',\n  styleUrls: ['./register-teacher.component.css']\n})\n\nexport class RegisterTeacherComponent {\n  constructor(private userService:UserService){}\n\n  username:string = \"\"\n  password:string = \"\"\n  safeQuestion: string= \"\"\n  safeResponse:string = \"\"\n  name:string = \"\"\n  lastName:string = \"\"\n  gender:string = \"\"\n  adr:string = \"\"\n  phone:string = \"\"\n  email:string = \"\"\n  schoolType:string = \"\"\n  grade:number = 0\n  photo:File|null = null\n  cv:File|null = null\n  message:string = \"\"\n  imageWidth:number = 0\n  imageHeight:number = 0\n\n  subjects = [\n    { label: 'Matematika', value: 'math' },\n    { label: 'Fizika', value: 'physics' },\n    { label: 'Hemija', value: 'chemistry' },\n    { label: 'Informatika', value: 'info' },\n    { label: 'Programiranje', value: 'programming' },\n    { label: 'Srpski jezik i književnost', value: 'srb' },\n    { label: 'Engleski jezik', value: 'eng' },\n    { label: 'Nemački jezik', value: 'ger' },\n    { label: 'Italijanski jezik', value: 'ita' },\n    { label: 'Francuski jezik', value: 'fra' },\n    { label: 'Španski jezik', value: 'spa' },\n    { label: 'Latinski jezik', value: 'lat' },\n    { label: 'Biologija', value: 'bio' },\n    { label: 'Istorija', value: 'hist' },\n    { label: 'Geografija', value: 'geo' },\n    { label: 'Svet oko nas', value: 'world' },\n    { label: 'Nešto drugo', value: 'other' }\n  ];\n  selectedSubjects: { [key: string]: boolean } = {};\n\n  onFileSelected(event: any) {\n    this.photo = event.target.files[0] as File;\n    const reader = new FileReader();\n\n    reader.onload = (e: any) => {\n      const img = new Image();\n      img.onload = () => {\n        this.imageWidth = img.naturalWidth;\n        this.imageHeight = img.naturalHeight;\n      };\n      img.src = e.target.result;\n    };\n\n    reader.readAsDataURL(this.photo);\n  }\n\n  onFileSelectedCV(event: any) {\n    this.cv = event.target.files[0] as File;\n  }\n\n  registerUser(){\n    // lozinka\n    console.log(\"OVDe\")\n    const regex = /^(?=.*[A-Z])(?=.*[a-z]{3})(?=.*\\d)(?=.*[!@#$%^&*()-_+=])[A-Za-z][A-Za-z\\d!@#$%^&*()-_+=]{5,9}$/;\n\n    if(!regex.test(this.password)){\n      this.message = \"Lozinka nije u dobrom formatu!\"\n      return\n    }\n\n    const phoneRegex = /^\\+3816\\d{8,9}$/;\n    if(!phoneRegex.test(this.phone)){\n      this.message = \"Telefon nije u dobrom formatu!\"\n      return\n    }\n\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(this.email)) {\n      this.message = \"Mejl nije u dobrom formatu!\"\n      return\n    }\n\n    if(this.grade < 1 || this.grade > 8){\n      this.message = \"Razred nije validan!\";\n      return;\n    }\n\n    if(this.schoolType != \"osnovna\" && this.grade > 4){\n      this.message = \"Razred nije validan za taj stepen obrazovanja!\";\n      return\n    }\n\n    let usePhoto = false;\n\n    if (!this.photo) {\n      usePhoto = true;\n    }else{\n      if (this.imageWidth > 300  || this.imageWidth < 100 || this.imageHeight > 300  || this.imageHeight < 100) {\n        this.message = 'Slika nije dozvoljene velicine.';\n        return;\n      }\n\n      const allowedFormats = ['image/jpeg', 'image/png'];\n      if (!allowedFormats.includes(this.photo.type)) {\n        this.message = 'Slika nije u dozvoljenom formatu. Dozvoljeni formati su JPG i PNG.';\n        return;\n      }\n    }\n\n    const imagePath = 'upload/user.png';\n    let newStudent = new User(this.username, this.password, this.safeQuestion, this.safeResponse, this.name, this.lastName, this.gender, this.adr, this.phone, this.email, imagePath, this.schoolType, this.grade);\n\n    this.userService.registerStudent(newStudent).subscribe(\n      (msg)=>{\n        this.message = msg.mess;\n        if(msg.code == 1){\n          this.message = \"Greska na serveru\";\n          return;\n        }else if(msg.code == 2){\n          this.message = \"Korisnik sa datim korisnickim imenom vec postoji!\"\n          return;\n        }else if(msg.code == 3){\n          this.message = \"Korisnik sa datim mejlom vec postoji!\"\n          return;\n        }else{\n          //success\n          if(usePhoto == false){\n            this.userService.uploadPhoto(this.photo, this.username).subscribe(\n              (user)=>{\n                if(user != null){\n                  localStorage.setItem(\"user\", JSON.stringify(user));\n                }\n              }\n            )\n          }\n        }\n      }\n    )\n  }\n}\n"],"mappings":";AAAA,SAASA,SAAS,QAAQ,eAAe;AAEzC,SAASC,IAAI,QAAQ,gBAAgB;AAQ9B,WAAMC,wBAAwB,GAA9B,MAAMA,wBAAwB;EACnCC,YAAoBC,WAAuB;IAAvB,KAAAA,WAAW,GAAXA,WAAW;IAE/B,KAAAC,QAAQ,GAAU,EAAE;IACpB,KAAAC,QAAQ,GAAU,EAAE;IACpB,KAAAC,YAAY,GAAU,EAAE;IACxB,KAAAC,YAAY,GAAU,EAAE;IACxB,KAAAC,IAAI,GAAU,EAAE;IAChB,KAAAC,QAAQ,GAAU,EAAE;IACpB,KAAAC,MAAM,GAAU,EAAE;IAClB,KAAAC,GAAG,GAAU,EAAE;IACf,KAAAC,KAAK,GAAU,EAAE;IACjB,KAAAC,KAAK,GAAU,EAAE;IACjB,KAAAC,UAAU,GAAU,EAAE;IACtB,KAAAC,KAAK,GAAU,CAAC;IAChB,KAAAC,KAAK,GAAa,IAAI;IACtB,KAAAC,EAAE,GAAa,IAAI;IACnB,KAAAC,OAAO,GAAU,EAAE;IACnB,KAAAC,UAAU,GAAU,CAAC;IACrB,KAAAC,WAAW,GAAU,CAAC;IAEtB,KAAAC,QAAQ,GAAG,CACT;MAAEC,KAAK,EAAE,YAAY;MAAEC,KAAK,EAAE;IAAM,CAAE,EACtC;MAAED,KAAK,EAAE,QAAQ;MAAEC,KAAK,EAAE;IAAS,CAAE,EACrC;MAAED,KAAK,EAAE,QAAQ;MAAEC,KAAK,EAAE;IAAW,CAAE,EACvC;MAAED,KAAK,EAAE,aAAa;MAAEC,KAAK,EAAE;IAAM,CAAE,EACvC;MAAED,KAAK,EAAE,eAAe;MAAEC,KAAK,EAAE;IAAa,CAAE,EAChD;MAAED,KAAK,EAAE,4BAA4B;MAAEC,KAAK,EAAE;IAAK,CAAE,EACrD;MAAED,KAAK,EAAE,gBAAgB;MAAEC,KAAK,EAAE;IAAK,CAAE,EACzC;MAAED,KAAK,EAAE,eAAe;MAAEC,KAAK,EAAE;IAAK,CAAE,EACxC;MAAED,KAAK,EAAE,mBAAmB;MAAEC,KAAK,EAAE;IAAK,CAAE,EAC5C;MAAED,KAAK,EAAE,iBAAiB;MAAEC,KAAK,EAAE;IAAK,CAAE,EAC1C;MAAED,KAAK,EAAE,eAAe;MAAEC,KAAK,EAAE;IAAK,CAAE,EACxC;MAAED,KAAK,EAAE,gBAAgB;MAAEC,KAAK,EAAE;IAAK,CAAE,EACzC;MAAED,KAAK,EAAE,WAAW;MAAEC,KAAK,EAAE;IAAK,CAAE,EACpC;MAAED,KAAK,EAAE,UAAU;MAAEC,KAAK,EAAE;IAAM,CAAE,EACpC;MAAED,KAAK,EAAE,YAAY;MAAEC,KAAK,EAAE;IAAK,CAAE,EACrC;MAAED,KAAK,EAAE,cAAc;MAAEC,KAAK,EAAE;IAAO,CAAE,EACzC;MAAED,KAAK,EAAE,aAAa;MAAEC,KAAK,EAAE;IAAO,CAAE,CACzC;IACD,KAAAC,gBAAgB,GAA+B,EAAE;EAvCJ;EAyC7CC,cAAcA,CAACC,KAAU;IACvB,IAAI,CAACV,KAAK,GAAGU,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAS;IAC1C,MAAMC,MAAM,GAAG,IAAIC,UAAU,EAAE;IAE/BD,MAAM,CAACE,MAAM,GAAIC,CAAM,IAAI;MACzB,MAAMC,GAAG,GAAG,IAAIC,KAAK,EAAE;MACvBD,GAAG,CAACF,MAAM,GAAG,MAAK;QAChB,IAAI,CAACZ,UAAU,GAAGc,GAAG,CAACE,YAAY;QAClC,IAAI,CAACf,WAAW,GAAGa,GAAG,CAACG,aAAa;MACtC,CAAC;MACDH,GAAG,CAACI,GAAG,GAAGL,CAAC,CAACL,MAAM,CAACW,MAAM;IAC3B,CAAC;IAEDT,MAAM,CAACU,aAAa,CAAC,IAAI,CAACvB,KAAK,CAAC;EAClC;EAEAwB,gBAAgBA,CAACd,KAAU;IACzB,IAAI,CAACT,EAAE,GAAGS,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAS;EACzC;EAEAa,YAAYA,CAAA;IACV;IACAC,OAAO,CAACC,GAAG,CAAC,MAAM,CAAC;IACnB,MAAMC,KAAK,GAAG,gGAAgG;IAE9G,IAAG,CAACA,KAAK,CAACC,IAAI,CAAC,IAAI,CAACxC,QAAQ,CAAC,EAAC;MAC5B,IAAI,CAACa,OAAO,GAAG,gCAAgC;MAC/C;;IAGF,MAAM4B,UAAU,GAAG,iBAAiB;IACpC,IAAG,CAACA,UAAU,CAACD,IAAI,CAAC,IAAI,CAACjC,KAAK,CAAC,EAAC;MAC9B,IAAI,CAACM,OAAO,GAAG,gCAAgC;MAC/C;;IAGF,MAAM6B,UAAU,GAAG,4BAA4B;IAC/C,IAAI,CAACA,UAAU,CAACF,IAAI,CAAC,IAAI,CAAChC,KAAK,CAAC,EAAE;MAChC,IAAI,CAACK,OAAO,GAAG,6BAA6B;MAC5C;;IAGF,IAAG,IAAI,CAACH,KAAK,GAAG,CAAC,IAAI,IAAI,CAACA,KAAK,GAAG,CAAC,EAAC;MAClC,IAAI,CAACG,OAAO,GAAG,sBAAsB;MACrC;;IAGF,IAAG,IAAI,CAACJ,UAAU,IAAI,SAAS,IAAI,IAAI,CAACC,KAAK,GAAG,CAAC,EAAC;MAChD,IAAI,CAACG,OAAO,GAAG,gDAAgD;MAC/D;;IAGF,IAAI8B,QAAQ,GAAG,KAAK;IAEpB,IAAI,CAAC,IAAI,CAAChC,KAAK,EAAE;MACfgC,QAAQ,GAAG,IAAI;KAChB,MAAI;MACH,IAAI,IAAI,CAAC7B,UAAU,GAAG,GAAG,IAAK,IAAI,CAACA,UAAU,GAAG,GAAG,IAAI,IAAI,CAACC,WAAW,GAAG,GAAG,IAAK,IAAI,CAACA,WAAW,GAAG,GAAG,EAAE;QACxG,IAAI,CAACF,OAAO,GAAG,iCAAiC;QAChD;;MAGF,MAAM+B,cAAc,GAAG,CAAC,YAAY,EAAE,WAAW,CAAC;MAClD,IAAI,CAACA,cAAc,CAACC,QAAQ,CAAC,IAAI,CAAClC,KAAK,CAACmC,IAAI,CAAC,EAAE;QAC7C,IAAI,CAACjC,OAAO,GAAG,oEAAoE;QACnF;;;IAIJ,MAAMkC,SAAS,GAAG,iBAAiB;IACnC,IAAIC,UAAU,GAAG,IAAIrD,IAAI,CAAC,IAAI,CAACI,QAAQ,EAAE,IAAI,CAACC,QAAQ,EAAE,IAAI,CAACC,YAAY,EAAE,IAAI,CAACC,YAAY,EAAE,IAAI,CAACC,IAAI,EAAE,IAAI,CAACC,QAAQ,EAAE,IAAI,CAACC,MAAM,EAAE,IAAI,CAACC,GAAG,EAAE,IAAI,CAACC,KAAK,EAAE,IAAI,CAACC,KAAK,EAAEuC,SAAS,EAAE,IAAI,CAACtC,UAAU,EAAE,IAAI,CAACC,KAAK,CAAC;IAE9M,IAAI,CAACZ,WAAW,CAACmD,eAAe,CAACD,UAAU,CAAC,CAACE,SAAS,CACnDC,GAAG,IAAG;MACL,IAAI,CAACtC,OAAO,GAAGsC,GAAG,CAACC,IAAI;MACvB,IAAGD,GAAG,CAACE,IAAI,IAAI,CAAC,EAAC;QACf,IAAI,CAACxC,OAAO,GAAG,mBAAmB;QAClC;OACD,MAAK,IAAGsC,GAAG,CAACE,IAAI,IAAI,CAAC,EAAC;QACrB,IAAI,CAACxC,OAAO,GAAG,mDAAmD;QAClE;OACD,MAAK,IAAGsC,GAAG,CAACE,IAAI,IAAI,CAAC,EAAC;QACrB,IAAI,CAACxC,OAAO,GAAG,uCAAuC;QACtD;OACD,MAAI;QACH;QACA,IAAG8B,QAAQ,IAAI,KAAK,EAAC;UACnB,IAAI,CAAC7C,WAAW,CAACwD,WAAW,CAAC,IAAI,CAAC3C,KAAK,EAAE,IAAI,CAACZ,QAAQ,CAAC,CAACmD,SAAS,CAC9DK,IAAI,IAAG;YACN,IAAGA,IAAI,IAAI,IAAI,EAAC;cACdC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACJ,IAAI,CAAC,CAAC;;UAEtD,CAAC,CACF;;;IAGP,CAAC,CACF;EACH;CACD;AA7IY3D,wBAAwB,GAAAgE,UAAA,EANpClE,SAAS,CAAC;EACTmE,QAAQ,EAAE,sBAAsB;EAChCC,WAAW,EAAE,mCAAmC;EAChDC,SAAS,EAAE,CAAC,kCAAkC;CAC/C,CAAC,C,EAEWnE,wBAAwB,CA6IpC"},"metadata":{},"sourceType":"module","externalDependencies":[]}